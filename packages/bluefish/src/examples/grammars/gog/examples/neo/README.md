Heavily copied from NEO Confusion Matrix repo.
